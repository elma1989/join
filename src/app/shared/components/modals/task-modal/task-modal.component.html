<!-- Modal Overlay -->
<div class="modal-overlay" (click)="closeTaskModal()">

	<!-- Modal Container -->
	<div class="task-modal-detail-container" [@slideInOut]="isOpen ? 'open' : 'closed'"
		(click)="$event.stopPropagation()">

		<div class="task-modal-header">
			<h2 [ngClass]="{ blue: task().category === Category.USERSTORY, green: task().category === Category.TECHNICAL, yellow: task().category === Category.TASK}">
				{{ task().category }}
			</h2>

			<button class="close" type="button" (click)="closeTaskModal()">X</button>
		</div>

		<div class="task-detail-main-container">

			<!-- Title + Description -->
			<section class="title-description-container">
				<div class="title">{{ task().title }}</div>
				<div class="description">{{ task().description }}</div>
			</section>

			<!-- Due Date -->
			<section class="task-modal-dueDate-container">
				<h3>Due date:</h3>
				<p>{{ task().dueDate.toDate() | date: 'dd.MM.yyyy' }}</p>
			</section>

			<!-- Priority -->
			<section class="task-modal-priority-container">
				<h3>Priority:</h3>
				<div class="task-modal-priority">
					<p>{{ task().priority }}</p>
					<img [src]="'assets/Icons/taskBoard/' + (task().priority | lowercase) + 'Task.png'"
						alt="Priority Icon" />
				</div>
			</section>

			<!-- Assigned Contacts -->
			<section class="task-modal-assigned-container">
				<h3>Assigned To:</h3>
				<div class="task-modal-assigned">
					<div class="task-modal-assigned-detail">
						@for (contact of task().contacts; track contact.id) {
						<div class="contact-item">
							<app-contact-icon class="contact-icon {{ contact.iconColor }}"
								[contact]="contact"></app-contact-icon>
							<span class="contact-name">
								{{ contact.getFullName() }}
							</span>
						</div>
						}
					</div>
				</div>
			</section>

			<!-- Subtasks -->
			<section class="task-modal-subtasks">
				<h3>Subtasks:</h3>
				<div class="task-modal-subtask-container">
					@for (subtask of task().subtasks; track subtask.id) {
					<label class="task-modal-input">
						<input type="checkbox" [checked]="subtask.finished"
							(change)="updateSubTaskStatus(subtask, $event)" />
						<span [title]="subtask.name">
							{{
							subtask.name.length > 30
							? (subtask.name | slice: 0: 30) + '...'
							: subtask.name
							}}
						</span>
					</label>
					}
				</div>
			</section>

		</div>

		<footer class="task-option-container">
			<button (click)="fireDB.deleteTaskInDB('tasks', task()); closeTaskModal()">
				<img class="delete-btn" src="assets/Icons/taskBoard/delete.png" alt="Delete" />
				Delete
			</button>

			<hr />

			<button (click)="modalService.openAddTaskModal(task()); closeTaskModal()">
				<img src="assets/Icons/taskBoard/edit.png" alt="Edit" />
				Edit
			</button>
		</footer>

	</div>
</div>