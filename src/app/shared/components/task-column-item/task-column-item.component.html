<div class="task-column-container">
	<div class="task-column-item-header">
		<h2
			[ngClass]="{ blue: task().category == Category.USERSTORY, green: task().category == Category.TECHNICAL, yellow: task().category == Category.TASK}">
			{{ task().category }}
		</h2>

		<div class="mobile-drop-container" id="mobileMenu">
			<button class="drop-btns" (click)="toggleMenu()">
				<img src="assets/Icons/taskBoard/arrow.png" alt="">
			</button>
		</div>

		@if (isDropdownOpen) {
		<div class="dropdown" (click)="$event.stopPropagation()">
			@for (list of availableStatus; track list.status) {
			<a (click)="changeStatus(list.status)">
				{{ list.listName }}
			</a>
			}
		</div>
		}
	</div>
	<div class="main-info-container" (click)="modalService.openTaskDetailModal(task())">
		<h3 class="title">
			<span class="text">{{ task().title }}</span>
		</h3>
		<p class="description limiter">{{task().description}}</p>

		@if (isSubtaskProgressVisible) {
		<div class="subtask-progress-box" (click)="$event.stopPropagation()">

			<div class="progress-bar-wrapper">
				<div class="progress-bar-background">
					<div class="progress-bar-fill" [style.width.%]="subtaskProgressPercentage"></div>
				</div>
				<span class="subtask-counter">
					<p>{{ completedSubtaskCount }}/{{ totalSubtaskCount }} Subtasks</p>
				</span>
			</div>

			<div class="subtask-tooltip">
				<strong>{{ completedSubtaskCount }} von {{ totalSubtaskCount }} Subtasks erledigt</strong>
				<ul class="subtask-list">
					@for (subtask of task().subtasks; track subtask.id; let i = $index) {
					@if (task().subtasks[i].editState != SubtaskEditState.DELETED) {
					<li class="subtask-item">
						<span [class.completed]="subtask.finished">{{ subtask.name }}</span>
					</li>
					}
					}
				</ul>
			</div>
		</div>
		}
		<div class="column-bottom-container">
			<app-contact-icon-list [contacts]="task().contacts"></app-contact-icon-list>
			<img src="assets/Icons/taskBoard/{{ task().priority | lowercase }}Task.png" alt="Priority Icon">
		</div>
	</div>
</div>